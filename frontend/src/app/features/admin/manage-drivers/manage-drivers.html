<div class="manage-drivers-container">
    <!-- Header -->
    <div class="header">
        <div class="title-section">
            <h1>Manage Drivers</h1>
            <p>Review and verify driver registrations</p>
        </div>
        <button class="btn-primary">
            <i class="bi bi-person-plus-fill"></i> Add New Driver
        </button>
    </div>

    <!-- Filters -->
    <div class="filters-card">
        <div class="search-box">
            <i class="bi bi-search"></i>
            <input type="text" placeholder="Search by name, CNIC, or license..." [(ngModel)]="searchTerm">
        </div>

        <div class="filter-tabs">
            <button [class.active]="activeTab === 'all'" (click)="setActiveTab('all')">All Drivers</button>
            <button [class.active]="activeTab === 'verified'" (click)="setActiveTab('verified')">Verified</button>
            <button [class.active]="activeTab === 'pending'" (click)="setActiveTab('pending')">Pending</button>
        </div>
    </div>

    <!-- Driver List -->
    <div class="list-card">
        <h3>Driver List</h3>

        <div class="table-responsive">
            <table class="drivers-table">
                <thead>
                    <tr>
                        <th>Driver</th>
                        <th>Contact</th>
                        <th>CNIC</th>
                        <th>License</th>
                        <th>Vehicle</th>
                        <th>Verification</th>
                        <th>Rating</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let driver of filteredDrivers">
                        <!-- Driver Info -->
                        <td class="driver-info">
                            <img [src]="driver.avatar" [alt]="driver.name">
                            <div>
                                <span class="name">{{ driver.name }}</span>
                                <span class="id">{{ driver.id }}</span>
                            </div>
                        </td>

                        <!-- Contact -->
                        <td>
                            <div class="contact-info">
                                <span>{{ driver.contact }}</span>
                            </div>
                        </td>

                        <!-- CNIC -->
                        <td class="code-text">{{ driver.cnic }}</td>

                        <!-- License -->
                        <td class="code-text">{{ driver.license }}</td>

                        <!-- Vehicle -->
                        <td>
                            <div class="vehicle-info">
                                <span>{{ driver.vehicle }}</span>
                            </div>
                        </td>

                        <!-- Verification -->
                        <td>
                            <div class="verification-icons">
                                <i class="bi bi-check-circle-fill success" *ngIf="driver.verification.documents"></i>
                                <i class="bi bi-x-circle-fill danger" *ngIf="!driver.verification.documents"></i>

                                <i class="bi bi-check-circle-fill success" *ngIf="driver.verification.vehicle"></i>
                                <i class="bi bi-x-circle-fill danger" *ngIf="!driver.verification.vehicle"></i>

                                <i class="bi bi-check-circle-fill success" *ngIf="driver.verification.background"></i>
                                <i class="bi bi-x-circle-fill danger" *ngIf="!driver.verification.background"></i>
                            </div>
                        </td>

                        <!-- Rating -->
                        <td>
                            <div class="rating" *ngIf="driver.rating">
                                <span class="score">{{ driver.rating }}</span>
                                <span class="count">({{ driver.totalTrips }})</span>
                            </div>
                            <span class="new-badge" *ngIf="!driver.rating">New</span>
                        </td>

                        <!-- Status -->
                        <td>
                            <span class="status-badge" [ngClass]="driver.status.toLowerCase()">
                                {{ driver.status }}
                            </span>
                        </td>

                        <!-- Actions/Status -->
                        <td class="actions-cell">
                            <button class="btn-icon" title="View Details">
                                <i class="bi bi-eye"></i>
                            </button>
                            <ng-container *ngIf="driver.status === 'Pending' || driver.status === 'New'">
                                <button class="btn-success" (click)="approveDriver(driver)">
                                    <i class="bi bi-check-lg"></i> Approve
                                </button>
                                <button class="btn-danger" (click)="rejectDriver(driver)">
                                    <i class="bi bi-x-lg"></i> Reject
                                </button>
                            </ng-container>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="filteredDrivers.length === 0">
            <p>No drivers found matching your criteria.</p>
        </div>
    </div>
</div>

<!-- Custom Confirmation Modal -->
<div class="modal-backdrop" *ngIf="showConfirmModal" (click)="closeModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
        <div class="modal-header" [ngClass]="confirmType">
            <i class="bi bi-check-circle-fill" *ngIf="confirmType === 'approve'"></i>
            <i class="bi bi-exclamation-circle-fill" *ngIf="confirmType === 'reject'"></i>
            <h3>{{ confirmType === 'approve' ? 'Approve Driver' : 'Reject Driver' }}</h3>
        </div>

        <div class="modal-body">
            <p>{{ confirmMessage }}</p>
        </div>

        <div class="modal-footer">
            <button class="btn-cancel" (click)="closeModal()">Cancel</button>
            <button [class]="confirmType === 'approve' ? 'btn-confirm-approve' : 'btn-confirm-reject'"
                (click)="onConfirm()">
                {{ confirmType === 'approve' ? 'Yes, Approve' : 'Yes, Reject' }}
            </button>
        </div>
    </div>
</div>