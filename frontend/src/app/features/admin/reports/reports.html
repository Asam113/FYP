<div class="reports-container">

    <!-- Header -->
    <div class="reports-header">
        <div class="title-section">
            <h1>Reports & Analytics</h1>
            <p>Comprehensive insights and data visualization</p>
        </div>
        <div class="actions">
            <div class="date-range-display">
                {{selectedRange}}
                <i class="fas fa-chevron-down"></i>
            </div>
            <button class="btn-export-all">
                <i class="fas fa-download"></i> Export All Reports
            </button>
        </div>
    </div>

    <!-- Summary Metrics -->
    <div class="metrics-grid">
        <div class="metric-card" *ngFor="let metric of metrics">
            <div class="metric-content">
                <span class="metric-title">{{metric.title}}</span>
                <div class="metric-value">
                    {{metric.value}}
                    <span class="sub-value" *ngIf="metric.subValue">{{metric.subValue}}</span>
                </div>
            </div>
            <div class="metric-icon" [ngClass]="metric.colorClass">
                <i class="fas" [ngClass]="metric.icon"></i>
            </div>
        </div>
    </div>

    <!-- Performance Chart -->
    <div class="chart-section">
        <div class="section-header">
            <h2>Monthly Performance Overview</h2>
            <button class="btn-sm-export">
                <i class="fas fa-download"></i> Export
            </button>
        </div>

        <div class="chart-container">
            <svg [attr.viewBox]="'0 0 ' + chartWidth + ' ' + chartHeight" preserveAspectRatio="none">

                <!-- Grid horizontal lines -->
                <g class="grid">
                    <line x1="40" y1="260" x2="760" y2="260" stroke="#f0f0f0" />
                    <line x1="40" y1="186" x2="760" y2="186" stroke="#f0f0f0" />
                    <line x1="40" y1="113" x2="760" y2="113" stroke="#f0f0f0" />
                    <line x1="40" y1="40" x2="760" y2="40" stroke="#f0f0f0" />
                </g>

                <!-- Y Axis Labels (Left - Count) -->
                <g class="labels y-labels-left">
                    <text x="35" y="260" text-anchor="end">0</text>
                    <text x="35" y="186" text-anchor="end">70</text>
                    <text x="35" y="113" text-anchor="end">140</text>
                    <text x="35" y="40" text-anchor="end">280</text>
                </g>

                <!-- Y Axis Labels (Right - Revenue) -->
                <g class="labels y-labels-right">
                    <text x="765" y="260" text-anchor="start">0</text>
                    <text x="765" y="186" text-anchor="start">200000</text>
                    <text x="765" y="113" text-anchor="start">400000</text>
                    <text x="765" y="40" text-anchor="start">800000</text>
                </g>

                <!-- Paths -->
                <path [attr.d]="pathCustomers" fill="none" class="line customers" /> <!-- Blue -->
                <path [attr.d]="pathRevenue" fill="none" class="line revenue" /> <!-- Orange -->
                <path [attr.d]="pathTours" fill="none" class="line tours" /> <!-- Teal -->

                <!-- X Axis Labels -->
                <g class="labels x-labels">
                    <text *ngFor="let p of performanceData; let i = index"
                        [attr.x]="40 + i * ((chartWidth - 80)/(performanceData.length - 1))" [attr.y]="chartHeight - 10"
                        text-anchor="middle">
                        {{p.label}}
                    </text>
                </g>
            </svg>
        </div>

        <div class="chart-legend">
            <div class="legend-item"><span class="dot customers"></span> Customers</div>
            <div class="legend-item"><span class="dot revenue"></span> Revenue (PKR)</div>
            <div class="legend-item"><span class="dot tours"></span> Tours</div>
        </div>
    </div>

    <div class="split-section">

        <!-- Top Destinations Chart -->
        <div class="card destinations-card">
            <div class="section-header">
                <h2>Top Destinations</h2>
                <button class="btn-sm-export">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
            <div class="bar-chart">
                <div class="bar-group" *ngFor="let dest of destinations">
                    <div class="bar-wrapper">
                        <div class="bar teal" [style.height.%]="getBarHeight(dest.value)">
                            <div class="tooltip">{{dest.value}}</div>
                        </div>
                    </div>
                    <span class="label rotated">{{dest.label}}</span>
                </div>
            </div>
        </div>

        <!-- Drivers List -->
        <div class="card drivers-card">
            <div class="section-header">
                <h2>Driver Performance</h2>
                <button class="btn-sm-export">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
            <div class="drivers-list">
                <div class="driver-item" *ngFor="let driver of drivers">
                    <!-- Placeholder avatar if none provided, or verify if existing logic holds -->
                    <div class="driver-details">
                        <div class="d-flex justify-between">
                            <span class="driver-name">{{driver.name}}</span>
                            <span class="driver-revenue">{{driver.revenue}}</span>
                        </div>
                        <div class="d-flex justify-between sub-details">
                            <span class="driver-tours">{{driver.tours}} tours</span>
                            <span class="driver-rating">
                                <i class="fas fa-star"></i> {{driver.rating}}
                                <span class="revenue-label">Revenue</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Export Section -->
    <div class="export-section">
        <h2>Export Detailed Reports</h2>
        <div class="export-grid">
            <button class="export-btn" *ngFor="let opt of exportOptions">
                <i class="far" [ngClass]="opt.icon"></i>
                <span>{{opt.title}}</span>
            </button>
        </div>
    </div>

</div>